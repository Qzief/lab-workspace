+<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Panel - Lab WorkSpace</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      id="hljs-light"
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
    />
    <link
      id="hljs-dark"
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark-dimmed.min.css"
      disabled
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            fontFamily: {
              segoe: ["Segoe UI", "system-ui", "sans-serif"],
            },
            colors: {
              "win-blue": "#0078d4",
              "win-light": "#f3f3f3",
              "win-dark": "#1e1e1e",
              "fluent-blue": "#005a9e",
              "fluent-light": "#f8f9fa",
              "fluent-dark": "#202020",
              acrylic: "rgba(255, 255, 255, 0.8)",
              mica: "rgba(243, 243, 243, 0.5)",
            },
            borderRadius: {
              fluent: "8px",
              "fluent-lg": "12px",
            },
            boxShadow: {
              fluent: "0 4px 16px rgba(0, 0, 0, 0.1)",
              "fluent-hover": "0 8px 32px rgba(0, 0, 0, 0.15)",
            },
            backdropBlur: {
              fluent: "20px",
            },
          },
        },
      };
    </script>
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* Custom Glassmorphism Styles with Fluent Design */
      .glass-card {
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37),
          inset 0 1px 0 0 rgba(255, 255, 255, 0.1);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border-radius: 12px;
      }

      .glass-card:hover {
        transform: translateY(-4px) scale(1.02);
        box-shadow: 0 12px 40px rgba(31, 38, 135, 0.5),
          inset 0 1px 0 0 rgba(255, 255, 255, 0.15);
      }

      .glass-nav {
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        background: rgba(255, 255, 255, 0.8);
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
      }

      .glass-button {
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        background: rgba(255, 255, 255, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.3);
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        border-radius: 8px;
      }

      .glass-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 16px rgba(59, 130, 246, 0.2);
        background: rgba(255, 255, 255, 0.8);
      }

      .glass-input {
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        background: rgba(255, 255, 255, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.3);
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        border-radius: 8px;
      }

      .glass-input:focus {
        transform: translateY(-1px);
        box-shadow: 0 4px 16px rgba(59, 130, 246, 0.3);
        background: rgba(255, 255, 255, 0.6);
      }

      .glass-logo {
        box-shadow: 0 4px 16px rgba(59, 130, 246, 0.3),
          inset 0 1px 0 0 rgba(255, 255, 255, 0.2);
        border-radius: 12px;
      }

      /* Mica-like background */
      .mica-bg {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.1) 0%,
          rgba(255, 255, 255, 0.05) 100%
        );
        background-image: radial-gradient(
            circle at 25% 25%,
            rgba(255, 255, 255, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 75% 75%,
            rgba(255, 255, 255, 0.05) 0%,
            transparent 50%
          );
      }

      /* Dark mode adjustments */
      .dark .glass-card {
        background: rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .dark .glass-nav {
        background: rgba(0, 0, 0, 0.8);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .dark .glass-button {
        background: rgba(0, 0, 0, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .dark .glass-button:hover {
        background: rgba(0, 0, 0, 0.6);
      }

      .dark .glass-input {
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .dark .glass-input:focus {
        background: rgba(0, 0, 0, 0.5);
      }

      .dark .mica-bg {
        background: linear-gradient(
          135deg,
          rgba(0, 0, 0, 0.1) 0%,
          rgba(0, 0, 0, 0.05) 100%
        );
        background-image: radial-gradient(
            circle at 25% 25%,
            rgba(0, 0, 0, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 75% 75%,
            rgba(0, 0, 0, 0.05) 0%,
            transparent 50%
          );
      }

      /* Smooth scrolling */
      html {
        scroll-behavior: smooth;
      }

      /* Custom scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
      }

      ::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb {
        background: rgba(59, 130, 246, 0.5);
        border-radius: 4px;
        backdrop-filter: blur(10px);
      }

      ::-webkit-scrollbar-thumb:hover {
        background: rgba(59, 130, 246, 0.7);
      }

      /* Dark mode scrollbar */
      .dark ::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.2);
      }

      .dark ::-webkit-scrollbar-thumb {
        background: rgba(156, 163, 175, 0.5);
      }

      .dark ::-webkit-scrollbar-thumb:hover {
        background: rgba(156, 163, 175, 0.7);
      }

      /* Animation for cards */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .fade-in-up {
        animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
      }

      /* Prose styling for markdown content */
      .prose {
        color: #374151;
      }

      .dark .prose {
        color: #d1d5db;
      }

      .prose h1,
      .prose h2,
      .prose h3,
      .prose h4,
      .prose h5,
      .prose h6 {
        color: #111827;
        font-weight: 600;
      }

      .dark .prose h1,
      .dark .prose h2,
      .dark .prose h3,
      .dark .prose h4,
      .dark .prose h5,
      .dark .prose h6 {
        color: #f9fafb;
      }

      .prose a {
        color: #3b82f6;
        text-decoration: none;
        border-bottom: 1px solid transparent;
        transition: border-color 0.2s;
      }

      .prose a:hover {
        border-bottom-color: #3b82f6;
      }

      .prose code {
        background: rgba(59, 130, 246, 0.1);
        color: #1f2937;
        padding: 0.2em 0.4em;
        border-radius: 0.375rem;
        font-size: 0.875em;
      }

      .dark .prose code {
        background: rgba(59, 130, 246, 0.2);
        color: #e5e7eb;
      }

      .prose pre {
        background: rgba(0, 0, 0, 0.05);
        color: #1f2937;
        border-radius: 0.75rem;
        padding: 1rem;
        overflow-x: auto;
        position: relative;
      }

      .dark .prose pre {
        background: rgba(255, 255, 255, 0.05);
        color: #e5e7eb;
      }

      .prose blockquote {
        border-left: 4px solid #3b82f6;
        padding-left: 1rem;
        font-style: italic;
        background: rgba(59, 130, 246, 0.05);
        color: #4b5563;
        border-radius: 0 0.5rem 0.5rem 0;
        margin: 1rem 0;
        padding: 1rem;
      }

      .dark .prose blockquote {
        background: rgba(59, 130, 246, 0.1);
        color: #d1d5db;
      }

      .prose p {
        color: #4b5563;
      }

      .dark .prose p {
        color: #d1d5db;
      }

      .prose li {
        color: #4b5563;
      }

      .dark .prose li {
        color: #d1d5db;
      }

      .prose strong {
        color: #111827;
      }

      .dark .prose strong {
        color: #f9fafb;
      }

      /* Focus styles for accessibility */
      .glass-button:focus,
      .glass-input:focus {
        outline: 2px solid #3b82f6;
        outline-offset: 2px;
      }

      /* Reduced motion for accessibility */
      @media (prefers-reduced-motion: reduce) {
        * {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }

        html {
          scroll-behavior: auto;
        }
      }

      /* Mica background for body */
      body {
        background: linear-gradient(135deg, #f0f0f0 0%, #e0e0e0 100%);
        background-attachment: fixed;
      }

      .dark body {
        background: linear-gradient(135deg, #1a1a1a 0%, #0d0d0d 100%);
        background-attachment: fixed;
      }

      /* Use JetBrains Mono across the site */
      html,
      body {
        min-height: 100%;
      }
      body {
        font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo,
          Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        display: flex;
        flex-direction: column;
      }
      main {
        flex: 1 0 auto;
      }

      /* Footer hover overflow fix */
      footer.glass-card {
        transform: none;
      }
      footer.glass-card:hover {
        transform: none !important;
      }

      /* Penjaga scrollbar horizontal */
      html,
      body {
        overflow-x: hidden;
      }
    </style>
  </head>
  <body
    class="font-segoe bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 min-h-screen flex flex-col transition-all duration-300"
  >
    <!-- Navigation -->
    <nav
      class="glass-nav fixed top-0 left-0 right-0 z-50 backdrop-blur-xl bg-white/20 dark:bg-gray-900/20 border-b border-white/20 dark:border-gray-700/20"
    >
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <div class="flex items-center space-x-4">
            <div
              class="glass-logo w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center"
            >
              <span class="text-white font-bold text-lg">LW</span>
            </div>
            <h1 class="text-xl font-semibold text-gray-800 dark:text-white">
              Lab WorkSpace Admin
            </h1>
          </div>

          <div class="flex items-center space-x-4">
            <!-- Navigation Dropdown -->
            <div class="relative">
              <button
                id="navDropdownButton"
                class="glass-button flex items-center gap-2 px-3 py-2 rounded-xl backdrop-blur-md bg-white/30 dark:bg-gray-800/30 border border-white/20 dark:border-gray-700/20 hover:bg-white/40 dark:hover:bg-gray-700/40 transition-all duration-200"
                aria-haspopup="true"
                aria-expanded="false"
              >
                <svg
                  class="w-5 h-5 text-gray-600 dark:text-gray-300"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 6h16M4 12h16M4 18h16"
                  ></path>
                </svg>
                <span
                  class="text-gray-700 dark:text-gray-200 text-sm font-medium"
                  >Menu</span
                >
                <svg
                  class="w-4 h-4 text-gray-600 dark:text-gray-300"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 9l-7 7-7-7"
                  ></path>
                </svg>
              </button>

              <div
                id="navDropdown"
                class="absolute right-0 mt-2 w-48 glass-card rounded-xl p-2 backdrop-blur-xl bg-white/20 dark:bg-gray-800/20 border border-white/20 dark:border-gray-700/20 shadow-2xl hidden z-50"
                role="menu"
                aria-label="Navigasi utama"
              >
                <a
                  href="index.html"
                  class="block px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-white/40 dark:hover:bg-gray-700/40 rounded-lg transition-colors"
                  role="menuitem"
                  >Home</a
                >
                <a
                  href="create-article.html"
                  class="block px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-white/40 dark:hover:bg-gray-700/40 rounded-lg transition-colors"
                  role="menuitem"
                  >Create Article</a
                >
                <a
                  href="#"
                  id="logoutBtn"
                  class="block px-3 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors"
                  role="menuitem"
                  >Logout</a
                >
              </div>
            </div>

            <!-- Dark Mode Toggle -->
            <button
              id="darkModeToggle"
              class="glass-button p-2 rounded-xl backdrop-blur-md bg-white/30 dark:bg-gray-800/30 border border-white/20 dark:border-gray-700/20 hover:bg-white/40 dark:hover:bg-gray-700/40 transition-all duration-200"
            >
              <svg
                class="w-5 h-5 text-gray-600 dark:text-gray-300"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
                ></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-20 pb-12 flex-1">
      <!-- Login Form -->
      <div id="loginSection" class="max-w-md mx-auto px-4 sm:px-6 lg:px-8">
        <div
          class="glass-card rounded-3xl p-8 backdrop-blur-xl bg-white/20 dark:bg-gray-800/20 border border-white/20 dark:border-gray-700/20 shadow-2xl"
        >
          <h2
            class="text-3xl font-bold text-gray-800 dark:text-white mb-6 text-center"
          >
            Admin Login
          </h2>

          <form id="loginForm" class="space-y-6">
            <div>
              <label
                for="username"
                class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2"
                >Username</label
              >
              <input
                type="text"
                id="username"
                name="username"
                required
                class="glass-input w-full px-4 py-3 rounded-xl backdrop-blur-md bg-white/30 dark:bg-gray-800/30 border border-white/20 dark:border-gray-700/20 text-gray-800 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50"
                placeholder="Enter admin username"
              />
            </div>

            <div>
              <label
                for="password"
                class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2"
                >Password</label
              >
              <input
                type="password"
                id="password"
                name="password"
                required
                class="glass-input w-full px-4 py-3 rounded-xl backdrop-blur-md bg-white/30 dark:bg-gray-800/30 border border-white/20 dark:border-gray-700/20 text-gray-800 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50"
                placeholder="Enter admin password"
              />
            </div>

            <button
              type="submit"
              id="loginBtn"
              class="glass-button w-full inline-flex items-center justify-center gap-2 px-6 py-3 text-lg font-medium text-gray-700 dark:text-gray-200 hover:bg-white/40 dark:hover:bg-gray-700/40 transition-all duration-200"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"
                ></path>
              </svg>
              Login
            </button>
          </form>

          <div
            id="loginError"
            class="hidden mt-4 p-3 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"
          >
            <p class="text-red-800 dark:text-red-200 text-sm">
              Invalid username or password
            </p>
          </div>
        </div>
      </div>

      <!-- Admin Panel -->
      <div id="adminPanel" class="hidden">
        <!-- Header -->
        <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-8">
          <div
            class="glass-card rounded-3xl p-6 backdrop-blur-xl bg-white/20 dark:bg-gray-800/20 border border-white/20 dark:border-gray-700/20 shadow-2xl"
          >
            <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-4">
              Admin Panel
            </h2>
            <p class="text-gray-600 dark:text-gray-300">
              Manage articles: view, edit, and delete existing articles.
            </p>
          </div>
        </section>

        <!-- Articles List -->
        <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div
            class="glass-card rounded-2xl p-6 backdrop-blur-xl bg-white/20 dark:bg-gray-800/20 border border-white/20 dark:border-gray-700/20 shadow-2xl"
          >
            <div class="flex justify-between items-center mb-6">
              <h3 class="text-xl font-semibold text-gray-800 dark:text-white">
                Articles
              </h3>
              <button
                id="refreshBtn"
                class="glass-button px-4 py-2 rounded-xl backdrop-blur-md bg-white/30 dark:bg-gray-800/30 border border-white/20 dark:border-gray-700/20 hover:bg-white/40 dark:hover:bg-gray-700/40 transition-all duration-200"
              >
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
                  ></path>
                </svg>
              </button>
            </div>

            <div id="articlesList" class="space-y-4">
              <!-- Articles will be loaded here -->
            </div>

            <div id="loadingArticles" class="text-center py-8">
              <div class="inline-flex items-center gap-3">
                <div
                  class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"
                ></div>
                <span class="text-gray-600 dark:text-gray-300"
                  >Loading articles...</span
                >
              </div>
            </div>

            <div id="noArticles" class="hidden text-center py-8">
              <svg
                class="w-16 h-16 text-gray-400 mx-auto mb-4"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                ></path>
              </svg>
              <h3
                class="text-xl font-semibold text-gray-600 dark:text-gray-300 mb-2"
              >
                No articles found
              </h3>
              <p class="text-gray-500 dark:text-gray-400">
                There are no articles to manage at the moment.
              </p>
            </div>
          </div>
        </section>
      </div>
    </main>

    <!-- Footer -->
    <footer
      class="glass-card backdrop-blur-xl bg-white/20 dark:bg-gray-800/20 border-t border-white/20 dark:border-gray-700/20 py-8 mt-auto"
    >
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <div
          class="flex flex-col sm:flex-row items-center justify-between gap-4"
        >
          <p class="text-gray-600 dark:text-gray-300 order-2 sm:order-1">
            © 2025 - 2026 Lab WorkSpace Admin Panel.
          </p>
          <div class="flex items-center gap-4 order-1 sm:order-2">
            <!-- GitHub -->
            <a
              href="https://github.com/Qzief/lab-workspace"
              target="_blank"
              rel="noopener noreferrer"
              class="glass-button p-2 rounded-xl backdrop-blur-md bg-white/30 dark:bg-gray-800/30 border border-white/20 dark:border-gray-700/20 hover:bg-white/40 dark:hover:bg-gray-700/40 transition-all duration-200 group"
              title="GitHub"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                class="bi bi-github"
                viewBox="0 0 16 16"
              >
                <path
                  d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.01 8.01 0 0 0 16 8c0-4.42-3.58-8-8-8"
                />
              </svg>
            </a>
          </div>
        </div>
      </div>
    </footer>

    <script>
      // Dark mode toggle
      const darkModeToggle = document.getElementById("darkModeToggle");
      const html = document.documentElement;
      const isDarkMode = localStorage.getItem("darkMode") === "true";

      if (isDarkMode) {
        html.classList.add("dark");
      }

      darkModeToggle.addEventListener("click", () => {
        const currentDark = html.classList.contains("dark");
        html.classList.toggle("dark");
        localStorage.setItem("darkMode", !currentDark);
      });

      // Navigation dropdown
      const navBtn = document.getElementById("navDropdownButton");
      const navDd = document.getElementById("navDropdown");

      if (navBtn && navDd) {
        const toggleNav = () => {
          const isHidden = navDd.classList.contains("hidden");
          navDd.classList.toggle("hidden");
          navBtn.setAttribute("aria-expanded", isHidden ? "true" : "false");
        };

        navBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          toggleNav();
        });

        // Close if click outside
        document.addEventListener("click", (e) => {
          if (!navDd.classList.contains("hidden")) {
            const within =
              navDd.contains(e.target) || navBtn.contains(e.target);
            if (!within) {
              navDd.classList.add("hidden");
              navBtn.setAttribute("aria-expanded", "false");
            }
          }
        });
      }

      // Check if user is logged in
      const isLoggedIn = sessionStorage.getItem("adminLoggedIn") === "true";

      if (isLoggedIn) {
        document.getElementById("loginSection").classList.add("hidden");
        document.getElementById("adminPanel").classList.remove("hidden");
        loadArticles();
      }

      // Login form
      const loginForm = document.getElementById("loginForm");
      const loginBtn = document.getElementById("loginBtn");
      const loginError = document.getElementById("loginError");

      loginForm.addEventListener("submit", async (e) => {
        e.preventDefault();

        const username = document.getElementById("username").value;
        const password = document.getElementById("password").value;

        loginBtn.disabled = true;
        loginBtn.innerHTML =
          '<div class="animate-spin rounded-full h-5 w-5 border-b-2 border-gray-700 dark:border-gray-200"></div> Logging in...';

        try {
          const response = await fetch("/.netlify/functions/admin-login", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ username, password }),
          });

          const data = await response.json();

          if (response.ok && data.success) {
            sessionStorage.setItem("adminLoggedIn", "true");
            document.getElementById("loginSection").classList.add("hidden");
            document.getElementById("adminPanel").classList.remove("hidden");
            loadArticles();
          } else {
            loginError.classList.remove("hidden");
          }
        } catch (error) {
          console.error("Login error:", error);
          loginError.classList.remove("hidden");
        } finally {
          loginBtn.disabled = false;
          loginBtn.innerHTML =
            '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path></svg> Login';
        }
      });

      // Logout
      document.getElementById("logoutBtn").addEventListener("click", () => {
        sessionStorage.removeItem("adminLoggedIn");
        document.getElementById("adminPanel").classList.add("hidden");
        document.getElementById("loginSection").classList.remove("hidden");
        loginForm.reset();
        loginError.classList.add("hidden");
      });

      // Load articles
      async function loadArticles() {
        const articlesList = document.getElementById("articlesList");
        const loadingArticles = document.getElementById("loadingArticles");
        const noArticles = document.getElementById("noArticles");

        loadingArticles.classList.remove("hidden");
        articlesList.innerHTML = "";
        noArticles.classList.add("hidden");

        try {
          const response = await fetch("posts/index.json");
          const articles = await response.json();

          loadingArticles.classList.add("hidden");

          if (articles.length === 0) {
            noArticles.classList.remove("hidden");
            return;
          }

          for (const filename of articles) {
            const articleCard = await createArticleCard(filename);
            articlesList.appendChild(articleCard);
          }
        } catch (error) {
          console.error("Error loading articles:", error);
          loadingArticles.classList.add("hidden");
          articlesList.innerHTML =
            '<p class="text-red-600 dark:text-red-400">Error loading articles</p>';
        }
      }

      // Create article card
      async function createArticleCard(filename) {
        try {
          const response = await fetch(`posts/${filename}`);
          const content = await response.text();

          // Parse frontmatter
          const frontmatterMatch = content.match(
            /^---\n([\s\S]*?)\n---\n([\s\S]*)$/
          );
          let title = filename;
          let date = "";
          let author = "";
          let excerpt = "";

          if (frontmatterMatch) {
            const frontmatter = frontmatterMatch[1];
            const frontmatterLines = frontmatter.split("\n");
            for (const line of frontmatterLines) {
              const [key, ...valueParts] = line.split(": ");
              const value = valueParts.join(": ").replace(/^["']|["']$/g, "");
              if (key === "title") title = value;
              if (key === "date") date = value;
              if (key === "author") author = value;
              if (key === "excerpt") excerpt = value;
            }
          }

          const card = document.createElement("div");
          card.className =
            "glass-card p-4 rounded-xl backdrop-blur-md bg-white/20 dark:bg-gray-800/20 border border-white/20 dark:border-gray-700/20";
          card.innerHTML = `
            <div class="flex justify-between items-start">
              <div class="flex-1">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-white mb-1">${title}</h4>
                <p class="text-sm text-gray-600 dark:text-gray-300 mb-2">By ${author} • ${date}</p>
                <p class="text-sm text-gray-500 dark:text-gray-400 line-clamp-2">${excerpt}</p>
              </div>
              <div class="flex gap-2 ml-4">
                <button
                  class="edit-btn glass-button px-3 py-2 rounded-lg backdrop-blur-md bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 hover:bg-blue-100 dark:hover:bg-blue-800/30 transition-all duration-200"
                  data-filename="${filename}"
                >
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                  </svg>
                </button>
                <button
                  class="delete-btn glass-button px-3 py-2 rounded-lg backdrop-blur-md bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 hover:bg-red-100 dark:hover:bg-red-800/30 transition-all duration-200"
                  data-filename="${filename}"
                >
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                  </svg>
                </button>
              </div>
            </div>
          `;

          // Add event listeners
          const editBtn = card.querySelector(".edit-btn");
          const deleteBtn = card.querySelector(".delete-btn");

          editBtn.addEventListener("click", () => {
            const filename = editBtn.dataset.filename;
            window.location.href = `create-article.html?edit=${encodeURIComponent(
              filename
            )}`;
          });

          deleteBtn.addEventListener("click", () => {
            const filename = deleteBtn.dataset.filename;
            if (confirm(`Are you sure you want to delete "${title}"?`)) {
              deleteArticle(filename);
            }
          });

          return card;
        } catch (error) {
          console.error("Error creating article card:", error);
          return document.createElement("div");
        }
      }

      // Delete article
      async function deleteArticle(filename) {
        try {
          const response = await fetch("/.netlify/functions/delete-article", {
            method: "DELETE",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ filename }),
          });

          if (response.ok) {
            loadArticles(); // Reload the list
          } else {
            const errorData = await response.json();
            alert(`Error deleting article: ${errorData.error}`);
          }
        } catch (error) {
          console.error("Delete error:", error);
          alert("Error deleting article");
        }
      }

      // Refresh button
      document
        .getElementById("refreshBtn")
        .addEventListener("click", loadArticles);
    </script>
  </body>
</html>
